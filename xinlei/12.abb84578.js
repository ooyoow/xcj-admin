(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{1018:function(e,t,l){var r=l(1019);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,l(2).default)("72fa75ba",r,!0,{})},1019:function(e,t,l){},1066:function(e,t,l){"use strict";l.r(t);var r=l(15),a=l(627);l(1018);function o(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{},r=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(l).filter(function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable}))),r.forEach(function(t){i(e,t,l[t])})}return e}function i(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var n={name:"user",data:function(){return{prefixCls:"xcj-user",sourceOptions:[{value:1,label:"微信"},{value:2,label:"小程序"},{value:3,label:"共享联盟"},{value:4,label:"集团客户"}],showMoreFilter:!1,formSimpleFilter:{search:"",registrationDays:"",nickName:"",source:"",currentPage:1,size:10},formMoreFilter:{},user:{loading:!1,list:[],total:0},consume:{visible:!1,loading:!1,currentPage:1,size:10,list:[],total:0},editDialog:{visible:!1,rules:{},temp:{}}}},created:function(){this.getUserList()},methods:{getUserList:function(){var e=this,t=this.formSimpleFilter,l=this.formMoreFilter,a=(this.getUserList,Object.assign({},t,l));this.user.loading=!0,Object(r.a)({url:"/api/v1/user/queryUserList",method:"get",params:a}).then(function(t){var l=t.resultObj,r=t.totalSize;e.user={loading:!1,list:l||[],total:r}})},getConsumeList:function(e){var t=this;this.consume=o({},this.consume,{visible:!0,loading:!0}),Object(r.a)({url:"/api/v1/user/queryUseRecdList",method:"get",params:{userId:e}}).then(function(e){var l=e.resultObj;e.totalSize;t.consume=o({},t.consume,{loading:!1,list:l||[],total:l.length})}).catch(function(e){t.consume.loading=!1})},handleSearch:function(){this.getUserList()},handleMoreFilter:function(){this.showMoreFilter=!this.showMoreFilter},handleSizeChange:function(e){this.formSimpleFilter.size=e,this.getUserList()},handleCurrentChange:function(e){this.formSimpleFilter.currentPage=e,this.getUserList()},handleConsumeList:function(e){this.getConsumeList(e.userId)},handleUpdate:function(e){var t=this;this.editDialog=o({},this.editDialog,{visible:!0,temp:Object.assign({},e)}),this.$nextTick(function(){t.$refs.editForm.clearValidate()})},handleDelete:function(){},updateUser:function(){},handleConsumeSizeChange:function(e){this.consume.size=e},handleConsumeCurrentChange:function(e){this.consume.currentPage=e},calcConsumeList:function(){var e=this.consume,t=e.list,l=e.currentPage,r=e.size;return t.slice((l-1)*r,l*r)},formatDate:function(e,t,l){return a.b.format(l)},formatUseData:function(e,t,l){var r=e.num,a=e.usedNum,o=r-a;return"".concat(a,"/").concat(o)}}},s=l(13),c=Object(s.a)(n,function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"xcj-user"},[l("div",{staticClass:"xcj-user-filter"},[l("el-form",{attrs:{inline:!0,model:e.formSimpleFilter}},[l("el-form-item",{attrs:{label:"用户账号"}},[l("el-input",{attrs:{clearable:"",placeholder:"请输入用户账号"},model:{value:e.formSimpleFilter.search,callback:function(t){e.$set(e.formSimpleFilter,"search",t)},expression:"formSimpleFilter.search"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"手机号"}},[l("el-input",{attrs:{type:"number",clearable:"",placeholder:"请输入手机号查询"},model:{value:e.formMoreFilter.phone,callback:function(t){e.$set(e.formMoreFilter,"phone",t)},expression:"formMoreFilter.phone"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"车牌号"}},[l("el-input",{attrs:{clearable:"",placeholder:"请输入车牌号查询"},model:{value:e.formMoreFilter.cardNo,callback:function(t){e.$set(e.formMoreFilter,"cardNo",t)},expression:"formMoreFilter.cardNo"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"会龄"}},[l("el-input",{attrs:{type:"number",clearable:"",placeholder:"请输入会龄查询"},model:{value:e.formSimpleFilter.registrationDays,callback:function(t){e.$set(e.formSimpleFilter,"registrationDays",e._n(t))},expression:"formSimpleFilter.registrationDays"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"来源"}},[l("el-select",{attrs:{clearable:"",placeholder:"请选择来源"},model:{value:e.formMoreFilter.source,callback:function(t){e.$set(e.formMoreFilter,"source",t)},expression:"formMoreFilter.source"}},e._l(e.sourceOptions,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),l("el-form-item",[l("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("查询")])],1)],1)],1),e._v(" "),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.user.loading,expression:"user.loading"}],attrs:{data:e.user.list,"highlight-current-row":""}},[l("el-table-column",{attrs:{prop:"userName",label:"用户账号",align:"center","show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{prop:"nickName",label:"用户昵称",align:"center","show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{prop:"phone",label:"手机号",align:"center","show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{prop:"carBrand",label:"车辆",align:"center","show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{prop:"registrationDays",label:"会龄",align:"center","show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{prop:"source",label:"来源",align:"center","show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{prop:"totalPayOrders",label:"销售额",align:"center","show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{prop:"serviceAmount",label:"服务额",align:"center","show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{prop:"orderNumber",label:"订单数量",align:"center","show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{prop:"createtime",label:"创建时间",align:"center",formatter:e.formatDate,"show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text"},on:{click:function(l){e.handleConsumeList(t.row)}}},[e._v("查看")])]}}])})],1),e._v(" "),l("div",{class:e.prefixCls+"-pagination"},[l("el-pagination",{attrs:{background:"","current-page":e.formSimpleFilter.currentPage,"page-sizes":[10,20,30,50],"page-size":e.formSimpleFilter.size,layout:"total, sizes, prev, pager, next, jumper",total:e.user.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),l("el-dialog",{attrs:{title:"消费详情",border:"",width:"90%",visible:e.consume.visible},on:{"update:visible":function(t){e.$set(e.consume,"visible",t)}}},[l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.consume.loading,expression:"consume.loading"}],attrs:{data:e.calcConsumeList()}},[l("el-table-column",{attrs:{property:"pName",align:"center",label:"产品名称"}}),e._v(" "),l("el-table-column",{attrs:{property:"pCode",align:"center",label:"产品编码"}}),e._v(" "),l("el-table-column",{attrs:{property:"marketPrice",align:"center",label:"市场价"}}),e._v(" "),l("el-table-column",{attrs:{property:"payMoney",align:"center",label:"售价"}}),e._v(" "),l("el-table-column",{attrs:{property:"usedNum",align:"center",label:"已用/可用",formatter:e.formatUseData}}),e._v(" "),l("el-table-column",{attrs:{property:"payTime",align:"center",label:"下单时间","show-overflow-tooltip":"",formatter:e.formatDate}}),e._v(" "),l("el-table-column",{attrs:{property:"useTime",align:"center",label:"洗车时间","show-overflow-tooltip":"",formatter:e.formatDate}}),e._v(" "),l("el-table-column",{attrs:{property:"cardNo",align:"center",label:"车牌"}}),e._v(" "),l("el-table-column",{attrs:{property:"storeName",label:"服务门店"}}),e._v(" "),l("el-table-column",{attrs:{property:"driverName",label:"终端名称"}})],1),e._v(" "),e.consume.total?l("div",{class:e.prefixCls+"-pagination"},[l("el-pagination",{attrs:{background:"","page-sizes":[10,20,30],layout:"total, sizes, prev, pager, next, jumper",total:e.consume.total},on:{"size-change":e.handleConsumeSizeChange,"current-change":e.handleConsumeCurrentChange}})],1):e._e()],1),e._v(" "),l("el-dialog",{attrs:{title:"编辑信息",visible:e.editDialog.visible},on:{"update:visible":function(t){e.$set(e.editDialog,"visible",t)}}},[l("el-form",{ref:"editForm",attrs:{rules:e.editDialog.rules,model:e.editDialog.temp,"label-position":"right"}},[l("el-form-item",{attrs:{label:"用户账号",prop:"userName"}},[l("el-input",{model:{value:e.editDialog.temp.userName,callback:function(t){e.$set(e.editDialog.temp,"userName",t)},expression:"editDialog.temp.userName"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"用户昵称",prop:"nickName"}},[l("el-input",{model:{value:e.editDialog.temp.nickName,callback:function(t){e.$set(e.editDialog.temp,"nickName",t)},expression:"editDialog.temp.nickName"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"车辆",prop:"carBrand"}},[l("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请添加车牌"},model:{value:e.editDialog.temp.carBrand,callback:function(t){e.$set(e.editDialog.temp,"carBrand",t)},expression:"editDialog.temp.carBrand"}},e._l(e.editDialog.temp.carBrand,function(e){return l("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"销售额",prop:"totalPayOrders"}},[l("el-input",{model:{value:e.editDialog.temp.totalPayOrders,callback:function(t){e.$set(e.editDialog.temp,"totalPayOrders",t)},expression:"editDialog.temp.totalPayOrders"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"服务额",prop:"serviceAmount"}},[l("el-input",{model:{value:e.editDialog.temp.serviceAmount,callback:function(t){e.$set(e.editDialog.temp,"serviceAmount",t)},expression:"editDialog.temp.serviceAmount"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"订单数量",prop:"orderNumber"}},[l("el-input",{model:{value:e.editDialog.temp.orderNumber,callback:function(t){e.$set(e.editDialog.temp,"orderNumber",t)},expression:"editDialog.temp.orderNumber"}})],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.editDialog.visible=!1}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:e.updateUser}},[e._v("确认")])],1)],1)],1)},[],!1,null,null,null);c.options.__file="index.vue";t.default=c.exports},627:function(e,t,l){"use strict";l.d(t,"b",function(){return o}),l.d(t,"d",function(){return i}),l.d(t,"a",function(){return n}),l.d(t,"c",function(){return s});var r=l(634);function a(e,t){for(var l=0;l<t.length;l++){var r=t[l];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,l,o;return t=e,o=[{key:"format",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e&&"number"==typeof e?Object(r.format)(e,t):""}}],(l=null)&&a(t.prototype,l),o&&a(t,o),e}(),i=function(e,t){for(var l=[],a=e;a<=t;)l.push(Object(r.format)(a,"YYYY-MM-DD")),a+=864e5;return l},n=function(e){for(var t=[],l=1;l<13;l++)l<10?t.push("".concat(e,"-0").concat(l)):t.push("".concat(e,"-").concat(l));return t},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e&&"number"==typeof e?Object(r.format)(e,t):""}}}]);