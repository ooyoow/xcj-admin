(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{1006:function(e,t,r){var a=r(1007);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,r(2).default)("fa3290cc",a,!0,{})},1007:function(e,t,r){},1067:function(e,t,r){"use strict";r.r(t);var a=r(15),l=(r(86),r(627));r(1006);function i(e,t){if(null==e)return{};var r,a,l=function(e,t){if(null==e)return{};var r,a,l={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(l[r]=e[r]);return l}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}var n={name:"Terminal",data:function(){return{prefixCls:"xcj-terminal",formSearch:{search:"",storeId:""},listQuery:{currentPage:1,size:10},listLoading:!1,terminalList:[],total:0,storeOptions:[],dialogFormVisible:!1,dialogStatus:"create",dialogType:{create:"新增",update:"编辑"},statusOptions:[{label:"空闲",value:1},{label:"忙碌",value:2},{label:"故障",value:3}],typeOptions:[{label:"龙门机",value:1},{label:"隧道机",value:2}],rules:{currCardno:[{required:!0,message:"终端编号不能为空",trigger:"change"}],driverName:[{required:!0,message:"终端名称不能为空",trigger:"change"}],driverid:[{required:!0,message:"终端ID不能为空",trigger:"change"}],manufactor:[{required:!0,message:"厂家不能为空",trigger:"change"}],mode:[{required:!0,message:"型号不能为空",trigger:"change"}],type:[{required:!0,message:"设备类型不能为空",trigger:"change"}],storeId:[{required:!0,message:"所属门店不能为空",trigger:"change"}],state:[{required:!0,message:"工作状态不能为空",trigger:"change"}]},terminalTemp:this.defaultTerminalTemp()}},created:function(){this.getStoreByLoginUser(),this.getTerminal()},methods:{handleCurrentChange:function(e){this.listQuery.currentPage=e,this.getTerminal()},handleSizeChange:function(e){this.listQuery.size=e,this.getTerminal()},getStoreByLoginUser:function(){var e=this;Object(a.a)({url:"/api/v1/store/queryStoreByUser",method:"get"}).then(function(t){var r=t.resultObj;r&&Array.isArray(r)&&(e.storeOptions=r.map(function(e){return{label:e.storeName,value:e.storeId}}))})},getTerminal:function(){var e=this,t=Object.assign({},this.formSearch,this.listQuery);this.listLoading=!0,Object(a.a)({url:"/api/v1/driver/queryDriverList",method:"get",params:t}).then(function(t){e.listLoading=!1;var r=t.resultObj,a=t.totalSize;e.terminalList=r,e.total=a})},handleCreate:function(){var e=this;this.terminalTemp=this.defaultTerminalTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},handleUpdate:function(e){var t=this,r=(e.createTime,e.updateTime,e.updateUser,e.createUser,i(e,["createTime","updateTime","updateUser","createUser"]));this.terminalTemp=Object.assign({},r),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},handleDelete:function(e){var t=this;Object(a.a)({url:"/api/v1/driver/deleteDriverInfo",method:"post",params:{driverid:e}}).then(function(){var r=!0,a=!1,l=void 0;try{for(var i,n=t.terminalList[Symbol.iterator]();!(r=(i=n.next()).done);r=!0){var o=i.value;if(o.driverid===e){var s=t.terminalList.indexOf(o);t.terminalList.splice(s,1),t.$message({message:"删除成功",type:"success"});break}}}catch(e){a=!0,l=e}finally{try{r||null==n.return||n.return()}finally{if(a)throw l}}})},createTerminal:function(){var e=this;this.$refs.dataForm.validate(function(t){t&&Object(a.a)({url:"/api/v1/driver/addDriverInfo",method:"post",data:e.terminalTemp}).then(function(){e.terminalList.unshift(e.terminalTemp),e.dialogFormVisible=!1,e.$notify({title:"成功",message:"添加成功",type:"success",duration:2e3})})})},updateTerminal:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){var r=Object.assign({},e.terminalTemp);Object(a.a)({url:"/api/v1/driver/editDriverInfo",method:"post",data:r}).then(function(){var t=!0,a=!1,l=void 0;try{for(var i,n=e.terminalList[Symbol.iterator]();!(t=(i=n.next()).done);t=!0){var o=i.value;if(o.driverid===r.driverid){var s=e.terminalList.indexOf(o);e.terminalList.splice(s,1,r);break}}}catch(e){a=!0,l=e}finally{try{t||null==n.return||n.return()}finally{if(a)throw l}}e.dialogFormVisible=!1,e.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})})}})},defaultTerminalTemp:function(){return{driverName:"",driverid:"",currCardno:"",manufactor:"",model:"",state:"",storeId:"",type:""}},formatTime:function(e,t,r){return l.b.format(r)},formatState:function(e,t,r){return{1:"空闲",2:"忙碌",3:"故障"}[r]},formatType:function(e,t,r){return{1:"龙门机",2:"隧道机"}[r]}}},o=r(13),s=Object(o.a)(n,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:e.prefixCls},[r("el-form",{attrs:{inline:!0,model:e.formSearch}},[r("el-form-item",{attrs:{label:"终端名称"}},[r("el-input",{attrs:{clearable:"",placeholder:"请输入终端名称/ID搜索"},model:{value:e.formSearch.search,callback:function(t){e.$set(e.formSearch,"search",t)},expression:"formSearch.search"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"所属门店"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择所属门店"},model:{value:e.formSearch.storeId,callback:function(t){e.$set(e.formSearch,"storeId",t)},expression:"formSearch.storeId"}},e._l(e.storeOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getTerminal}},[e._v("查询")])],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("添加")])],1)],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],class:e.prefixCls+"-table",attrs:{data:e.terminalList}},[r("el-table-column",{attrs:{prop:"driverid",label:"终端ID",align:"center","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"currCardno",label:"终端编号",align:"center","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"driverName",label:"终端名称",align:"center","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"manufactor",label:"厂家",align:"center","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"model",label:"型号",align:"center","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"type",label:"设备类型",align:"center","show-overflow-tooltip":"",formatter:e.formatType}}),e._v(" "),r("el-table-column",{attrs:{prop:"storeName",label:"所属门店",align:"center","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"state",label:"工作状态",align:"center","show-overflow-tooltip":"",formatter:e.formatState}}),e._v(" "),r("el-table-column",{attrs:{prop:"createTime",label:"添加时间",align:"center","show-overflow-tooltip":"",formatter:e.formatTime}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.handleUpdate(t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.handleDelete(t.row.driverid)}}},[e._v("删除")])]}}])})],1),e._v(" "),r("div",{class:e.prefixCls+"-pagination"},[r("el-pagination",{attrs:{background:"","current-page":e.listQuery.currentPage,"page-sizes":[10,20,30,50],"page-size":e.listQuery.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-dialog",{attrs:{title:e.dialogType[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.terminalTemp,"label-position":"right","label-width":"100px"}},[r("el-form-item",{attrs:{label:"终端ID",prop:"driverid"}},[r("el-input",{attrs:{readonly:"update"===e.dialogStatus},model:{value:e.terminalTemp.driverid,callback:function(t){e.$set(e.terminalTemp,"driverid",t)},expression:"terminalTemp.driverid"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"终端编号",prop:"currCardno"}},[r("el-input",{model:{value:e.terminalTemp.currCardno,callback:function(t){e.$set(e.terminalTemp,"currCardno",t)},expression:"terminalTemp.currCardno"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"终端名称",prop:"driverName"}},[r("el-input",{model:{value:e.terminalTemp.driverName,callback:function(t){e.$set(e.terminalTemp,"driverName",t)},expression:"terminalTemp.driverName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"厂家",prop:"manufactor"}},[r("el-input",{model:{value:e.terminalTemp.manufactor,callback:function(t){e.$set(e.terminalTemp,"manufactor",t)},expression:"terminalTemp.manufactor"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"设备类型",prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择设备类型"},model:{value:e.terminalTemp.type,callback:function(t){e.$set(e.terminalTemp,"type",t)},expression:"terminalTemp.type"}},e._l(e.typeOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"所属门店",prop:"storeId"}},[r("el-select",{attrs:{placeholder:"请选择所属门店"},model:{value:e.terminalTemp.storeId,callback:function(t){e.$set(e.terminalTemp,"storeId",t)},expression:"terminalTemp.storeId"}},e._l(e.storeOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"工作状态",prop:"state"}},[r("el-select",{attrs:{readonly:"update"===e.dialogStatus,placeholder:"请选择工作状态"},model:{value:e.terminalTemp.state,callback:function(t){e.$set(e.terminalTemp,"state",t)},expression:"terminalTemp.state"}},e._l(e.statusOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"型号",prop:"model"}},[r("el-input",{model:{value:e.terminalTemp.model,callback:function(t){e.$set(e.terminalTemp,"model",t)},expression:"terminalTemp.model"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),"create"==e.dialogStatus?r("el-button",{attrs:{type:"primary"},on:{click:e.createTerminal}},[e._v("确认")]):r("el-button",{attrs:{type:"primary"},on:{click:e.updateTerminal}},[e._v("确认")])],1)],1)],1)},[],!1,null,null,null);s.options.__file="index.vue";t.default=s.exports},627:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"d",function(){return n}),r.d(t,"a",function(){return o}),r.d(t,"c",function(){return s});var a=r(634);function l(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,i;return t=e,i=[{key:"format",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e&&"number"==typeof e?Object(a.format)(e,t):""}}],(r=null)&&l(t.prototype,r),i&&l(t,i),e}(),n=function(e,t){for(var r=[],l=e;l<=t;)r.push(Object(a.format)(l,"YYYY-MM-DD")),l+=864e5;return r},o=function(e){for(var t=[],r=1;r<13;r++)r<10?t.push("".concat(e,"-0").concat(r)):t.push("".concat(e,"-").concat(r));return t},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e&&"number"==typeof e?Object(a.format)(e,t):""}}}]);