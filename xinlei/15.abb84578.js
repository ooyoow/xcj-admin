(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1036:function(e,t,a){var n=a(1037);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(2).default)("5dffeee7",n,!0,{})},1037:function(e,t,a){},1057:function(e,t,a){"use strict";a.r(t);var n=a(15),o=a(627);a(1036);function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){i(e,t,a[t])})}return e}function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l={data:function(){return{prefixCls:"xcj-system-account",formSearch:{loginId:"",name:"",currentPage:1,size:10},listLoading:!1,dataList:[],total:0,typeOptions:[{label:"超级管理员",value:1},{label:"股东",value:2},{label:"门店管理员",value:3}],businessOptions:[],dialogVisible:!1,dialogStatus:"create",dialogType:{create:"新增账户",update:"编辑账户"},rules:{loginId:[{required:!0,trigger:"change",message:"请输入账户名"}],name:[{required:!0,trigger:"change",message:"请输入昵称"}],type:[{required:!0,trigger:"change",message:"请选择类型"}],password:[{required:!0,trigger:"change",message:"请输入密码"}],confirmPassword:[{required:!0,trigger:"change",message:"请输入确认密码"}]},accountTemp:this.initAccountTemp()}},filters:{activeFilter:function(e){return{0:"danger",1:"success"}[e]},activeNameFilter:function(e){return{0:"已禁用",1:"已启用"}[e]},businessFilter:function(e){return{2:"所有者",3:"门店"}[e]}},created:function(){this.getAccountList()},methods:{handleSearch:function(){this.formSearch.currentPage=1,this.getAccountList()},handleCurrentChange:function(e){this.formSearch.currentPage=e,this.getAccountList()},handleSizeChange:function(e){this.formSearch.size=e,this.getAccountList()},handleCreate:function(){this.setAccountDialog("create",this.initAccountTemp())},handleUpdate:function(e){var t=e.password,a=e.type;this.getBusinessOptions(a),this.setAccountDialog("update",Object.assign({confirmPassword:t},e))},handleDelete:function(){},handleModifyActive:function(e){var t=this,a=e.active,o={adminId:e.adminId,active:1===a?0:1};Object(n.a)({url:"/api/v1/admin/setAdminStatus",method:"post",params:o}).then(function(a){e.active=o.active,t.$message({message:"操作成功",type:"success"})})},getBusinessOptions:function(e){switch(e){case 2:this.getOrgOptions();break;case 3:this.getStoreOptions()}},createAccount:function(){var e=this;this.$refs.accountForm.validate(function(t){if(t){var a=e.accountTemp;if(a.password!==a.confirmPassword)return void e.$message({message:"密码与确认密码不一致",type:"warning"});Object(n.a)({url:"/api/v1/admin/addAdmin",method:"post",data:e.accountTemp}).then(function(){e.dataList.unshift(e.accountTemp),e.dialogFormVisible=!1,e.$notify({title:"成功",message:"添加成功",type:"success",duration:2e3})})}})},updateAccount:function(){var e=this;this.$refs.accountForm.validate(function(t){if(t){var a=e.accountTemp,o=(a.password,a.confirmPassword,s(a,["password","confirmPassword"]));Object(n.a)({url:"/api/v1/admin/editAdmin",method:"post",data:o}).then(function(){var t=!0,a=!1,n=void 0;try{for(var r,i=e.dataList[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var s=r.value;if(s.adminId===o.adminId){var l=e.dataList.indexOf(s);e.dataList.splice(l,1,o);break}}}catch(e){a=!0,n=e}finally{try{t||null==i.return||i.return()}finally{if(a)throw n}}e.dialogVisible=!1,e.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})})}})},setAccountDialog:function(e,t){var a=this;this.dialogStatus=e,this.accountTemp=t,this.dialogVisible=!0,this.$nextTick(function(){a.$refs.accountForm.clearValidate()})},getAccountList:function(){var e=this;this.listLoading=!0,Object(n.a)({url:"/api/v1/admin/queryAdminList",method:"get",params:this.formSearch}).then(function(t){e.listLoading=!1;var a=t.resultObj,n=t.totalSize;e.dataList=a,e.total=n})},getOrgOptions:function(){var e=this;Object(n.a)({method:"get",url:"/api/v1/store/queryOrgList"}).then(function(t){var a=t.resultObj;a&&Array.isArray(a)&&(e.businessOptions=a.map(function(e){var t=e.organizationId;return r({label:e.ownerName,value:t},s(e,["organizationId","ownerName"]))}))}).catch(function(t){e.businessOptions=[]})},getStoreOptions:function(){var e=this;Object(n.a)({method:"get",url:"/api/v1/store/queryStoreAll"}).then(function(t){var a=t.resultObj;a&&Array.isArray(a)&&(e.businessOptions=a.map(function(e){return r({label:e.storeName,value:e.storeId},s(e,["storeName","storeId"]))}))}).catch(function(t){e.businessOptions=[]})},formatType:function(e,t,a){return{1:"超级管理员",2:"股东",3:"门店管理员"}[a]},formatTime:function(e,t,a){return Object(o.c)(a)},initAccountTemp:function(){return{active:1,businessId:"",email:"",loginId:"",name:"",password:"",confirmPassword:"",type:""}}}},c=a(13),u=Object(c.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xcj-system-account"},[a("el-form",{staticClass:"form-filter",attrs:{inline:!0,model:e.formSearch}},[a("el-form-item",{attrs:{label:"账户名"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入账户名查询"},model:{value:e.formSearch.loginId,callback:function(t){e.$set(e.formSearch,"loginId",t)},expression:"formSearch.loginId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"昵称"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入昵称查询"},model:{value:e.formSearch.name,callback:function(t){e.$set(e.formSearch,"name",t)},expression:"formSearch.name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("查询")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.dataList,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"loginId",label:"账户名","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"昵称","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类型","show-overflow-tooltip":"",formatter:e.formatType}}),e._v(" "),a("el-table-column",{attrs:{prop:"email",label:"邮箱","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"active",label:"状态","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e._f("activeFilter")(t.row.active)}},[e._v(e._s(e._f("activeNameFilter")(t.row.active)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间","show-overflow-tooltip":"",formatter:e.formatTime}}),e._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"更新时间","show-overflow-tooltip":"",formatter:e.formatTime}}),e._v(" "),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.active?a("el-button",{attrs:{type:"text"},on:{click:function(a){e.handleModifyActive(t.row)}}},[e._v("禁用\n        ")]):e._e(),e._v(" "),0===t.row.active?a("el-button",{attrs:{type:"text"},on:{click:function(a){e.handleModifyActive(t.row)}}},[e._v("启用\n        ")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.handleUpdate(t.row)}}},[e._v("编辑")])]}}])})],1),e._v(" "),a("div",{class:e.prefixCls+"-pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.formSearch.currentPage,"page-sizes":[10,20,30,50],"page-size":e.formSearch.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogType[e.dialogStatus],visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"accountForm",attrs:{rules:e.rules,model:e.accountTemp,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"账户名",prop:"loginId"}},[a("el-input",{model:{value:e.accountTemp.loginId,callback:function(t){e.$set(e.accountTemp,"loginId",t)},expression:"accountTemp.loginId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"昵称",prop:"name"}},[a("el-input",{model:{value:e.accountTemp.name,callback:function(t){e.$set(e.accountTemp,"name",t)},expression:"accountTemp.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择类型"},on:{input:e.getBusinessOptions},model:{value:e.accountTemp.type,callback:function(t){e.$set(e.accountTemp,"type",t)},expression:"accountTemp.type"}},e._l(e.typeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),e.accountTemp.type&&1!==e.accountTemp.type?a("el-form-item",{attrs:{label:e._f("businessFilter")(e.accountTemp.type),prop:"businessId"}},[a("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.accountTemp.businessId,callback:function(t){e.$set(e.accountTemp,"businessId",t)},expression:"accountTemp.businessId"}},e._l(e.businessOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1):e._e(),e._v(" "),"create"===e.dialogStatus?a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.accountTemp.password,callback:function(t){e.$set(e.accountTemp,"password",t)},expression:"accountTemp.password"}})],1):e._e(),e._v(" "),"create"===e.dialogStatus?a("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[a("el-input",{attrs:{type:"password"},model:{value:e.accountTemp.confirmPassword,callback:function(t){e.$set(e.accountTemp,"confirmPassword",t)},expression:"accountTemp.confirmPassword"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.accountTemp.email,callback:function(t){e.$set(e.accountTemp,"email",t)},expression:"accountTemp.email"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),e._v(" "),"create"==e.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:e.createAccount}},[e._v("确认")]):a("el-button",{attrs:{type:"primary"},on:{click:e.updateAccount}},[e._v("确认")])],1)],1)],1)},[],!1,null,null,null);u.options.__file="index.vue";t.default=u.exports},627:function(e,t,a){"use strict";a.d(t,"b",function(){return r}),a.d(t,"d",function(){return i}),a.d(t,"a",function(){return s}),a.d(t,"c",function(){return l});var n=a(634);function o(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,a,r;return t=e,r=[{key:"format",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e&&"number"==typeof e?Object(n.format)(e,t):""}}],(a=null)&&o(t.prototype,a),r&&o(t,r),e}(),i=function(e,t){for(var a=[],o=e;o<=t;)a.push(Object(n.format)(o,"YYYY-MM-DD")),o+=864e5;return a},s=function(e){for(var t=[],a=1;a<13;a++)a<10?t.push("".concat(e,"-0").concat(a)):t.push("".concat(e,"-").concat(a));return t},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e&&"number"==typeof e?Object(n.format)(e,t):""}}}]);