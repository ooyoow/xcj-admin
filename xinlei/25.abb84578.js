(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{1010:function(e,t,a){var l=a(1011);"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);(0,a(2).default)("19886766",l,!0,{})},1011:function(e,t,a){},1058:function(e,t,a){"use strict";a.r(t);var l=a(17),r=(a(15),a(86));a(1010);function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){o(e,t,a[t])})}return e}function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var s={name:"package",data:function(){return{prefixCls:"xcj-product-package",listQuery:{search:"",type:0,currentPage:1,size:10,productStatus:"",sort:""},stats:{onlineNumber:0,warehouseNumber:0,count:0},listLoading:!1,dataList:[],total:0,dialogStatus:"create",dialogType:{create:"新增套餐",update:"编辑套餐"},dialogVisible:!1,pImgList:[],dataTemp:this.defaultTemp(),rules:{pName:[{required:!0,message:"套餐名称不能为空",trigger:"change"}],pCode:[{required:!0,message:"产品编号不能为空",trigger:"change"}],marketPrice:[{required:!0,message:"市场价不能为空",trigger:"change"}],pRice:[{required:!0,message:"产品售价不能为空",trigger:"change"}],pNum:[{required:!0,message:"次数不能为空",trigger:"change"}],pAllnum:[{required:!0,message:"发行量不能为空",trigger:"change"}],pRecommond:[{required:!0,message:"推荐指数不能为空",trigger:"change"}],pImg:[{required:!0,message:"产品图片不能为空",trigger:"change"}],advertisement:[{required:!0,message:"广告语不能为空",trigger:"change"}],upTime:[{required:!0,message:"上架时间不能为空",trigger:"change"}],downTime:[{required:!0,message:"下架时间不能为空",trigger:"change"}],pValidateTime:[{required:!0,message:"有效期不能为空",trigger:"change"}],pContent:[{required:!0,message:"简介不能为空",trigger:"change"}]}}},created:function(){var e=this;this.getDataList(),this.getProductStatsByType({params:{type:1},callback:function(t){var a=t.onlineNumber,l=t.warehouseNumber;e.stats={onlineNumber:a,warehouseNumber:l,count:a+l}}})},methods:i({},Object(l.b)(["getProduct","getProductStatsByType","createProduct","updateProduct","deleteProduct"]),{getDataList:function(){var e=this;this.listLoading=!0,this.getProduct({params:this.listQuery,callback:function(t){e.listLoading=!1;var a=t.list,l=t.total;e.dataList=a,e.total=l}})},onRadioChange:function(){this.getDataList()},handleSearch:function(e){this.getDataList()},handleCurrentChange:function(e){this.listQuery.currentPage=e,this.getDataList()},handleSizeChange:function(e){this.listQuery.size=e,this.getDataList()},handleCreate:function(){this.setDialog("create",this.defaultTemp())},handleUpdate:function(e){var t=e.pImg;this.pImgList=t?[{name:Object(r.d)(t),url:t}]:[],this.setDialog("update",e)},handleDelete:function(e){var t=this;this.deleteProduct({id:e,callback:function(a){var l=!0,r=!1,i=void 0;try{for(var o,s=t.dataList[Symbol.iterator]();!(l=(o=s.next()).done);l=!0){var n=o.value;if(n.id===e){var p=t.dataList.indexOf(n);t.dataList.splice(p,1),t.$message({message:"删除成功",type:"success"});break}}}catch(e){r=!0,i=e}finally{try{l||null==s.return||s.return()}finally{if(r)throw i}}}})},createPackage:function(){var e=this;this.$refs.dataForm.validate(function(t){t&&e.createProduct({params:e.dataTemp,callback:function(t){e.dataList.unshift(t.resultObj),e.dialogVisible=!1,e.$notify({title:"成功",message:"添加成功",type:"success",duration:2e3})}})})},updatePackage:function(){var e=this;this.$refs.dataForm.validate(function(t){t&&e.updateProduct({params:e.dataTemp,callback:function(t){var a=!0,l=!1,r=void 0;try{for(var i,o=e.dataList[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var s=i.value;if(s.id===e.dataTemp.id){var n=e.dataList.indexOf(s);e.dataList.splice(n,1,e.dataTemp);break}}}catch(e){l=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}e.dialogVisible=!1,e.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})}})})},onUploadSuccess:function(e,t,a){this.dataTemp.pImg=e.resultObj,this.$refs.pImg.clearValidate()},onUploadError:function(){this.$message({message:err.message||"服务异常",type:"error"})},setDialog:function(e,t){var a=this;this.dialogStatus=e,this.dataTemp=i({},t),this.dialogVisible=!0,this.$nextTick(function(){a.$refs.dataForm.clearValidate()})},defaultTemp:function(){return{pType:0,pName:"",pCode:"",marketPrice:"",pRice:"",pNum:"",pAllnum:"",pRecommond:"",pImg:"",advertisement:"",upTime:"",downTime:"",pValidateTime:"",pContent:""}}})},n=a(13),p=Object(n.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.prefixCls},[a("div",{staticClass:"filter-container"},[a("div",{staticClass:"filter-item"},[a("el-input",{staticClass:"txt",attrs:{clearable:"",placeholder:"输入套餐名称/产品编号搜索"},on:{input:e.handleSearch},model:{value:e.listQuery.search,callback:function(t){e.$set(e.listQuery,"search",t)},expression:"listQuery.search"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("添加")])],1),e._v(" "),a("div",{staticClass:"filter-item"},[a("el-radio-group",{on:{change:e.onRadioChange},model:{value:e.listQuery.productStatus,callback:function(t){e.$set(e.listQuery,"productStatus",t)},expression:"listQuery.productStatus"}},[a("el-radio-button",{attrs:{label:""}},[e._v("全部\n          "),a("span",[e._v("("+e._s(e.stats.count)+")")])]),e._v(" "),a("el-radio-button",{attrs:{label:"online"}},[e._v("今日在线\n          "),a("span",[e._v("("+e._s(e.stats.onlineNumber)+")")])]),e._v(" "),a("el-radio-button",{attrs:{label:"warehouse"}},[e._v("仓库\n          "),a("span",[e._v("("+e._s(e.stats.warehouseNumber)+")")])])],1)],1)]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],class:e.prefixCls+"-table",attrs:{data:e.dataList,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"pName",label:"套餐名称","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"pCode",label:"产品编号","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"pImg",align:"center",label:"产品图片","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{placement:"right",trigger:"hover"}},[a("div",{class:[e.prefixCls+"-table-view-img"]},[a("img",{attrs:{src:t.row.pImg}})]),e._v(" "),a("span",{staticClass:"column-img",attrs:{slot:"reference"},slot:"reference"},[e._v("预览")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"marketPrice",align:"center",label:"市场价","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"pRice",align:"center",label:"售价","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"pNum",label:"次数",align:"center","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"pAllnum",label:"发行量",align:"center","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"advertisement",label:"广告语","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"pContent",label:"简介","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"100 "},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.handleUpdate(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.handleDelete(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{class:e.prefixCls+"-pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.listQuery.currentPage,"page-sizes":[10,20,30,50],"page-size":e.listQuery.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{class:e.prefixCls+"-dialog",attrs:{title:e.dialogType[e.dialogStatus],visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.dataTemp,"label-position":"right","label-width":"100px"}},[a("el-form-item",{attrs:{label:"套餐名称",prop:"pName"}},[a("el-input",{model:{value:e.dataTemp.pName,callback:function(t){e.$set(e.dataTemp,"pName",t)},expression:"dataTemp.pName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"产品编号",prop:"pCode"}},[a("el-input",{model:{value:e.dataTemp.pCode,callback:function(t){e.$set(e.dataTemp,"pCode",t)},expression:"dataTemp.pCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"市场价",prop:"marketPrice"}},[a("el-input",{model:{value:e.dataTemp.marketPrice,callback:function(t){e.$set(e.dataTemp,"marketPrice",e._n(t))},expression:"dataTemp.marketPrice"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"售价",prop:"pRice"}},[a("el-input",{model:{value:e.dataTemp.pRice,callback:function(t){e.$set(e.dataTemp,"pRice",e._n(t))},expression:"dataTemp.pRice"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"次数",prop:"pNum"}},[a("el-input",{model:{value:e.dataTemp.pNum,callback:function(t){e.$set(e.dataTemp,"pNum",e._n(t))},expression:"dataTemp.pNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"发行量",prop:"pAllnum"}},[a("el-input",{model:{value:e.dataTemp.pAllnum,callback:function(t){e.$set(e.dataTemp,"pAllnum",t)},expression:"dataTemp.pAllnum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"推荐指数",prop:"pRecommond"}},[a("el-input",{model:{value:e.dataTemp.pRecommond,callback:function(t){e.$set(e.dataTemp,"pRecommond",e._n(t))},expression:"dataTemp.pRecommond"}})],1),e._v(" "),a("el-form-item",{ref:"pImg",attrs:{label:"产品图片",prop:"pImg"}},[a("el-upload",{attrs:{action:e.$base_url+"/api/v1/store/upload",limit:1,"file-list":e.pImgList,"on-success":e.onUploadSuccess,"on-error":this.onUploadError},model:{value:e.dataTemp.pImg,callback:function(t){e.$set(e.dataTemp,"pImg",t)},expression:"dataTemp.pImg"}},[a("el-button",{attrs:{type:"primary"}},[e._v("点击上传")]),e._v("  \n          "),a("span",{attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"广告语",prop:"advertisement"}},[a("el-input",{model:{value:e.dataTemp.advertisement,callback:function(t){e.$set(e.dataTemp,"advertisement",t)},expression:"dataTemp.advertisement"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上架时间",prop:"upTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"请上架时间"},model:{value:e.dataTemp.upTime,callback:function(t){e.$set(e.dataTemp,"upTime",t)},expression:"dataTemp.upTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"下架时间",prop:"downTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"请下架时间"},model:{value:e.dataTemp.downTime,callback:function(t){e.$set(e.dataTemp,"downTime",t)},expression:"dataTemp.downTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"有效期",prop:"pValidateTime"}},[a("el-input",{attrs:{placeholder:"请输入有效期/天"},model:{value:e.dataTemp.pValidateTime,callback:function(t){e.$set(e.dataTemp,"pValidateTime",e._n(t))},expression:"dataTemp.pValidateTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"简介",prop:"pContent"}},[a("el-input",{model:{value:e.dataTemp.pContent,callback:function(t){e.$set(e.dataTemp,"pContent",t)},expression:"dataTemp.pContent"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),e._v(" "),"create"==e.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:e.createPackage}},[e._v("确认")]):a("el-button",{attrs:{type:"primary"},on:{click:e.updatePackage}},[e._v("确认")])],1)],1)],1)},[],!1,null,null,null);p.options.__file="index.vue";t.default=p.exports}}]);