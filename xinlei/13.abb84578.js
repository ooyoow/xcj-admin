(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1008:function(e,t,r){var a=r(1009);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,r(2).default)("125c864f",a,!0,{})},1009:function(e,t,r){},1054:function(e,t,r){"use strict";r.r(t);r(86);var a=r(627),n=(r(1008),r(15)),l={name:"Owner",data:function(){return{prefixCls:"xcj-owner",listQuery:{ownerName:"",currentPage:1,size:10},listLoading:!1,list:[],total:0,levelOptions:[{label:"一级",value:1},{label:"二级",value:2}],dialogFormVisible:!1,dialogStatus:"create",dialogType:{create:"新增",update:"编辑"},rules:{ownerName:[{required:!0,message:"所有者名称不能为空",trigger:"change"}],level:[{required:!0,message:"请选择级别",trigger:"change"}]},ownerTemp:this.defaultOwnerTemp()}},created:function(){this.queryOwnerList()},methods:{handleCreate:function(){var e=this;this.ownerTemp=this.defaultOwnerTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},handleUpdate:function(e){var t=this,r=e.organizationId,a=e.ownerName,n=e.level,l=e.descri;this.ownerTemp={organizationId:r,ownerName:a,level:n,descri:l},this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},handleDelete:function(e){var t=this;(function(e){return Object(n.a)({url:"/api/v1/organization/deletOrg",method:"post",params:{organizationId:e}})})(e).then(function(){var r=!0,a=!1,n=void 0;try{for(var l,o=t.list[Symbol.iterator]();!(r=(l=o.next()).done);r=!0){var i=l.value;if(i.organizationId===e){var s=t.list.indexOf(i);t.list.splice(s,1),t.total=t.total-1,t.$message({message:"删除成功",type:"success"});break}}}catch(e){a=!0,n=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw n}}})},handleSizeChange:function(e){this.listQuery.size=value,this.queryOwnerList()},handleCurrentChange:function(e){this.listQuery.currentPage=e,this.queryOwnerList()},queryOwnerList:function(){var e=this,t=this.listQuery,r=t.ownerName,a=t.currentPage,l=t.size;this.listLoading=!0,function(e,t,r){return Object(n.a)({url:"/api/v1/organization/queryOrganization",method:"get",params:{ownerName:e,currentPage:t,size:r}})}(r,a,l).then(function(t){e.listLoading=!1;var r=t.resultObj,a=t.totalSize;e.list=r,e.total=a}).catch(function(t){e.listLoading=!1})},createOwner:function(){var e=this;this.$refs.dataForm.validate(function(t){var r;t&&(r=e.ownerTemp,Object(n.a)({url:"/api/v1/organization/addOrg",method:"post",data:r})).then(function(t){e.list.unshift(t.resultObj),e.dialogFormVisible=!1,e.$notify({title:"成功",message:"添加成功",type:"success",duration:2e3})})})},updateOwner:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){var r=Object.assign({},e.ownerTemp);(function(e){return Object(n.a)({url:"/api/v1/organization/editOrg",method:"post",data:e})})(r).then(function(t){var a=!0,n=!1,l=void 0;try{for(var o,i=e.list[Symbol.iterator]();!(a=(o=i.next()).done);a=!0){var s=o.value;if(s.organizationId===r.organizationId){var c=e.list.indexOf(s);e.list.splice(c,1,t.resultObj);break}}}catch(e){n=!0,l=e}finally{try{a||null==i.return||i.return()}finally{if(n)throw l}}e.dialogFormVisible=!1,e.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})})}})},calcOrderList:function(e){var t=e.list,r=e.currentPage,a=e.size;return t.slice((r-1)*a,r*a)},formatTime:function(e,t,r){return a.b.format(r)},formatLevel:function(e,t,r){return{1:"一级",2:"二级"}[r]},defaultOwnerTemp:function(){return{descri:"",level:"",ownerName:""}}},filters:{activeFilter:function(e){return{0:"无效",1:"有效"}[e]}}},o=r(13),i=Object(o.a)(l,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:e.prefixCls},[r("el-form",{attrs:{inline:!0}},[r("el-form-item",{attrs:{label:"所有者"}},[r("el-input",{attrs:{clearable:"",placeholder:"请输入所有者查询"},model:{value:e.listQuery.ownerName,callback:function(t){e.$set(e.listQuery,"ownerName",t)},expression:"listQuery.ownerName"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.queryOwnerList}},[e._v("查询")])],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("添加")])],1)],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],class:e.prefixCls+"-table",attrs:{data:e.list}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-table",{attrs:{border:"",data:t.row.storeOrganizationList}},[r("el-table-column",{attrs:{prop:"storeName",label:"门店名称",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"rate",label:"分润比例",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"updateUser",label:"更新人",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",align:"center",formatter:e.formatTime}})],1)]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"organizationId",label:"ID",align:"center","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"ownerName",label:"所有者名称",align:"center","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"level",label:"级别",align:"center","show-overflow-tooltip":"",formatter:e.formatLevel}}),e._v(" "),r("el-table-column",{attrs:{prop:"active",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{type:e._f("activeFilter")(t.row.active)}},[e._v(e._s(e._f("activeFilter")(t.row.active)))])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"createUser",label:"创建人",align:"center","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center","show-overflow-tooltip":"",formatter:e.formatTime}}),e._v(" "),r("el-table-column",{attrs:{prop:"updateUser",label:"更新人",align:"center","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",align:"center","show-overflow-tooltip":"",formatter:e.formatTime}}),e._v(" "),r("el-table-column",{attrs:{prop:"descri",label:"备注",align:"center","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.handleUpdate(t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.handleDelete(t.row.organizationId)}}},[e._v("删除")])]}}])})],1),e._v(" "),r("div",{class:e.prefixCls+"-pagination"},[r("el-pagination",{attrs:{background:"","current-page":e.listQuery.currentPage,"page-sizes":[10,20,30,50],"page-size":e.listQuery.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-dialog",{attrs:{title:e.dialogType[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.ownerTemp,"label-position":"right","label-width":"100px"}},[r("el-form-item",{attrs:{label:"所有者名称",prop:"ownerName"}},[r("el-input",{model:{value:e.ownerTemp.ownerName,callback:function(t){e.$set(e.ownerTemp,"ownerName",t)},expression:"ownerTemp.ownerName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"级别",prop:"level"}},[r("el-select",{attrs:{placeholder:"请选择级别"},model:{value:e.ownerTemp.level,callback:function(t){e.$set(e.ownerTemp,"level",t)},expression:"ownerTemp.level"}},e._l(e.levelOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"备注",prop:"descri"}},[r("el-input",{model:{value:e.ownerTemp.descri,callback:function(t){e.$set(e.ownerTemp,"descri",t)},expression:"ownerTemp.descri"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),"create"==e.dialogStatus?r("el-button",{attrs:{type:"primary"},on:{click:e.createOwner}},[e._v("确认")]):r("el-button",{attrs:{type:"primary"},on:{click:e.updateOwner}},[e._v("确认")])],1)],1)],1)},[],!1,null,null,null);i.options.__file="index.vue";t.default=i.exports},627:function(e,t,r){"use strict";r.d(t,"b",function(){return l}),r.d(t,"d",function(){return o}),r.d(t,"a",function(){return i}),r.d(t,"c",function(){return s});var a=r(634);function n(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,l;return t=e,l=[{key:"format",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e&&"number"==typeof e?Object(a.format)(e,t):""}}],(r=null)&&n(t.prototype,r),l&&n(t,l),e}(),o=function(e,t){for(var r=[],n=e;n<=t;)r.push(Object(a.format)(n,"YYYY-MM-DD")),n+=864e5;return r},i=function(e){for(var t=[],r=1;r<13;r++)r<10?t.push("".concat(e,"-0").concat(r)):t.push("".concat(e,"-").concat(r));return t},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e&&"number"==typeof e?Object(a.format)(e,t):""}}}]);