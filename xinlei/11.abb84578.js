(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1030:function(e,r,t){var a=t(1031);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,t(2).default)("0ce37368",a,!0,{})},1031:function(e,r,t){},1068:function(e,r,t){"use strict";t.r(r);var a=t(15),o=t(627),l=t(86);t(1030);function n(e,r){if(null==e)return{};var t,a,o=function(e,r){if(null==e)return{};var t,a,o={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},a=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.forEach(function(r){s(e,r,t[r])})}return e}function s(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var u={name:"sale",data:function(){return{prefixCls:"xcj-finance-sale",queryOrderParams:{date:[],orderNo:"",currentPage:1,size:10},order:{loading:!1,list:[],total:0},washDetail:{loading:!1,currentPage:1,size:5,list:[],total:0},productTypeOptions:[{label:"套餐卡",value:0},{label:"次卡",value:1},{label:"优惠券",value:2}],_getOrderList:null}},created:function(){var e=this;this.getOrderList(this.queryOrderParams),this._getOrderList=Object(l.a)(function(){e.queryOrderParams.currentPage=1,e.getOrderList(e.queryOrderParams)},200)},methods:{handleSizeChange:function(e){this.queryOrderParams.size=e,this.getOrderList()},handleCurrentChange:function(e,r){switch(r){case"order":this.queryOrderParams.currentPage=e,this.getOrderList();break;case"washDetail":this.washDetail.currentPage=e}},getOrderList:function(e){var r=this;this.order.loading=!0,Object(a.a)({url:"/api/v1/finance/queryOrderList",method:"get",params:this.formatqueryOrderParams(e)}).then(function(e){var t=e.resultObj,a=e.totalSize;r.order={loading:!1,list:t||[],total:a}}).catch(function(e){r.order.loading=!1})},getWashDetail:function(e){var r=this;this.washDetail=i({},this.washDetail,{currentPage:1,loading:!0}),Object(a.a)({url:"/api/v1/finance/queryUseRecordByOrderNo",method:"get",params:{orderNo:e}}).then(function(e){var t=e.resultObj;e.totalSize;r.washDetail=i({},r.washDetail,{loading:!1,list:t||[],total:Array.isArray(t)?t.length:0})}).catch(function(e){r.washDetail.loading=!1})},formatqueryOrderParams:function(){var e=this.queryOrderParams,r=e.date,t=n(e,["date"]);return i({start:r&&Array.isArray(r)?r[0]:"",end:r&&Array.isArray(r)?r[1]:""},t)},formatTime:function(e,r,t){return o.b.format(t)},formatPtype:function(e,r,t){return{0:"套餐卡",1:"次卡",2:"优惠券"}[t]},calcWashList:function(){var e=this.washDetail,r=e.list,t=e.currentPage,a=e.size;return r.slice((t-1)*a,t*a)}}},c=t(13),p=Object(c.a)(u,function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{class:e.prefixCls},[t("el-form",{staticClass:"filter-container",attrs:{inline:!0,model:e.queryOrderParams}},[t("el-form-item",{attrs:{label:"起止时间"}},[t("el-date-picker",{attrs:{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},on:{change:e._getOrderList},model:{value:e.queryOrderParams.date,callback:function(r){e.$set(e.queryOrderParams,"date",r)},expression:"queryOrderParams.date"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"订单号"}},[t("el-input",{attrs:{type:"number",clearable:""},on:{input:e._getOrderList},model:{value:e.queryOrderParams.orderNo,callback:function(r){e.$set(e.queryOrderParams,"orderNo",r)},expression:"queryOrderParams.orderNo"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"手机号码"}},[t("el-input",{attrs:{type:"number",clearable:""},on:{input:e._getOrderList},model:{value:e.queryOrderParams.phone,callback:function(r){e.$set(e.queryOrderParams,"phone",r)},expression:"queryOrderParams.phone"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"产品类型"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择产品类型"},on:{input:e._getOrderList},model:{value:e.queryOrderParams.pType,callback:function(r){e.$set(e.queryOrderParams,"pType",r)},expression:"queryOrderParams.pType"}},e._l(e.productTypeOptions,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.order.loading,expression:"order.loading"}],class:e.prefixCls+"-table",attrs:{data:e.order.list}},[t("el-table-column",{attrs:{width:"180",prop:"orderNo",label:"订单号","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{prop:"pName",label:"产品名称","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{prop:"pCode",label:"产品编号",align:"center","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{prop:"pType",label:"产品类型",align:"center","show-overflow-tooltip":"",formatter:e.formatPtype}}),e._v(" "),t("el-table-column",{attrs:{prop:"userName",label:"用户名",align:"center","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{width:"140",prop:"phone",label:"手机号码",align:"center","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{prop:"marketPrice",label:"市场价",align:"center","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{prop:"pRice",label:"售价",align:"center","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{prop:"usedNum",label:"已用/可用",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v("\n        "+e._s(r.row.usedNum?+r.row.usedNum:0)+"/"+e._s((r.row.num?r.row.num:0)-(r.row.usedNum?+r.row.usedNum:0))+"\n      ")]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"serviceAmount",label:"服务额",align:"center","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{prop:"storeName",label:"服务门店","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{prop:"cardNo",label:"服务车牌与时间",align:"center",width:"110"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-popover",{attrs:{placement:"top",trigger:"hover"},on:{show:function(t){e.getWashDetail(r.row.orderNo)}}},[t("div",[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.washDetail.loading,expression:"washDetail.loading"}],attrs:{data:e.calcWashList()}},[t("el-table-column",{attrs:{align:"center",prop:"storeName",label:"服务门店"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",property:"cardNo",label:"车牌"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",property:"useTime",width:"150",label:"洗车时间",formatter:e.formatTime}})],1),e._v(" "),t("br"),e._v(" "),t("div",[t("el-pagination",{attrs:{background:"","current-page":e.washDetail.currentPage,"page-size":e.washDetail.size,layout:"total, prev, pager, next, jumper",total:e.washDetail.total},on:{"current-change":function(r){e.handleCurrentChange(r,"washDetail")}}})],1)],1),e._v(" "),t("span",{staticClass:"wash-detail",attrs:{slot:"reference"},slot:"reference"},[e._v("详情")])])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"payResult",label:"支付状态","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{prop:"payTime",label:"支付时间",formatter:e.formatTime,"show-overflow-tooltip":""}})],1),e._v(" "),t("div",{class:e.prefixCls+"-pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.queryOrderParams.currentPage,"page-sizes":[10,20,30,50],"page-size":e.queryOrderParams.size,layout:"total, sizes, prev, pager, next, jumper",total:e.order.total},on:{"size-change":e.handleSizeChange,"current-change":function(r){e.handleCurrentChange(r,"order")}}})],1)],1)},[],!1,null,null,null);p.options.__file="index.vue";r.default=p.exports},627:function(e,r,t){"use strict";t.d(r,"b",function(){return l}),t.d(r,"d",function(){return n}),t.d(r,"a",function(){return i}),t.d(r,"c",function(){return s});var a=t(634);function o(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var l=function(){function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,t,l;return r=e,l=[{key:"format",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e&&"number"==typeof e?Object(a.format)(e,r):""}}],(t=null)&&o(r.prototype,t),l&&o(r,l),e}(),n=function(e,r){for(var t=[],o=e;o<=r;)t.push(Object(a.format)(o,"YYYY-MM-DD")),o+=864e5;return t},i=function(e){for(var r=[],t=1;t<13;t++)t<10?r.push("".concat(e,"-0").concat(t)):r.push("".concat(e,"-").concat(t));return r},s=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e&&"number"==typeof e?Object(a.format)(e,r):""}}}]);