(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1024:function(e,t,r){var a=r(1025);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,r(2).default)("30b3ec73",a,!0,{})},1025:function(e,t,r){},1047:function(e,t,r){"use strict";r.r(t);var a=r(634),n=r(709),s=r(647),i={mixins:[r(653).a],props:{width:{type:String,default:"200px"},height:{type:String,default:"200px"},legendData:{type:Array,default:function(){return[]}},seriesData:{type:Array,default:function(){return[]}}},data:function(){return{chart:null}},mounted:function(){this.initChart()},beforeUpdate:function(){this.initChart()},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=s.a.init(this.$refs.pie),this.chart.setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:this.legendData},series:[{name:"来源",type:"pie",radius:"55%",center:["50%","60%"],data:this.seriesData,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}}},o=r(13),u=Object(o.a)(i,function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"pie",style:{height:this.height,width:this.width},attrs:{seriesData:this.seriesData}})},[],!1,null,null,null);u.options.__file="pie.vue";var c=u.exports,l=r(708),h=r(15),p=r(627),f=r(86);r(1024);function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){y(e,t,r[t])})}return e}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var m=r(115),v={data:function(){return{prefixCls:"xcj-user-portrait",queryOptions:[{value:1,label:"按月统计"},{value:2,label:"按年统计"}],queryUserIncrease:this.initQueryParams(),queryUserPortSource:this.initQueryParams(),queryUserConsume:this.initQueryParams(),userIncreate:{xAxisData:[],seriesData:[]},userPortSource:{legendData:["微信","小程序","共享联盟","集团客户"],seriesData:[{name:"微信",value:0},{name:"小程序",value:0},{name:"共享联盟",value:0},{name:"集团客户",value:0}]},userConsumeChartOption:{color:["#3398DB"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:["0元","5-10元","11-50元","51-200元","201-1000元","1001-3000元","3001-10000元","10000元以上"],axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value",name:"（元）"}],series:[{name:"会员数",type:"bar",barWidth:"60%",data:[0,0,0,0,0,0,0,0,0]}]}}},components:{LineChart:n.a,Pie:c,Bar:l.a},created:function(){this.onInputQueryUserParam(),this.onInputQueryUserPortSource(),this.onQueryUserConsume()},methods:{getUserIncrease:function(e){var t=this;(function(e){return Object(h.a)({method:"get",url:"/api/v1/user/queryUserIncrease",params:e})})(e).then(function(r){var n=r.resultObj,s=(e.type,e.year),i=e.month,o=[],u=[];switch(e.type){case 1:var c="".concat(s,"-").concat(i),l=+Object(a.startOfMonth)(c),h=+Object(a.endOfMonth)(c);o=Object(p.d)(l,h);break;case 2:o=Object(p.a)(s)}u=o.map(function(e){return 0}),n.forEach(function(e){var t=e.axis,r=e.totalcount,a=o.indexOf(t);a>0&&(u[a]=r)}),t.userIncreate={xAxisData:o,seriesData:u}})},getUserPortSource:function(e){var t=this;Object(h.a)({method:"get",url:"/api/v1/user/queryUserSource",params:e}).then(function(e){var r=e.resultObj||{},a=r.groupCustomer,n=r.sharedAlliance,s=r.smallProgram,i=r.weChat;t.userPortSource.seriesData=[{name:"微信",value:i},{name:"小程序",value:s},{name:"共享联盟",value:n},{name:"集团客户",value:a}]})},getUserConsume:function(e){var t=this;Object(h.a)({method:"get",url:"/api/v1/user/queryUserConsumption",params:e}).then(function(e){var r=e.resultObj;if(r&&Array.isArray(r)){var a=[];r.map(function(e){a=Object.keys(e).map(function(t){return e[t]})}),t.userConsumeChartOption=d({},t.userConsumeChartOption,{series:d({},t.userConsumeChartOption.series,{data:a})})}})},onInputQueryUserParam:function(e){var t=this.transformQueryUserParams();this.getUserIncrease(t)},onInputQueryUserPortSource:function(){var e=this.queryUserPortSource,t=e.type,r=e.date,a=this.formatQueryParams(t,r);this.getUserPortSource(a)},onQueryUserConsume:function(){var e=this.queryUserConsume,t=e.type,r=e.date,a=this.formatQueryParams(t,r);this.getUserConsume(a)},formatQueryParams:function(e,t){var r={start:"",end:""};switch(e){case 1:Object.assign(r,{start:+Object(a.startOfMonth)(t),end:+Object(a.endOfMonth)(t)});break;case 2:Object.assign(r,{start:+Object(a.startOfMonth)("".concat(Object(a.format)(t,"YYYY"),"-01")),end:+Object(a.endOfMonth)("".concat(Object(a.format)(t,"YYYY"),"-12"))})}return r},initQueryParams:function(){return{type:1,date:Object(a.format)(new Date,"YYYY-MM")}},handleExportUser:function(){var e=this.transformQueryUserParams();window.open("".concat(m.baseUrl,"/api/v1/user/exportUserIncrease").concat(Object(f.c)(e)))},handleExportUserPortSource:function(){var e=this.queryUserPortSource,t=e.type,r=e.date,a=this.formatQueryParams(t,r);window.open("".concat(m.baseUrl,"/api/v1/user/exportUserSource").concat(Object(f.c)(a)))},handleExportUserConsume:function(){var e=this.queryUserConsume,t=e.type,r=e.date,a=this.formatQueryParams(t,r);window.open("".concat(app.baseUrl,"/api/v1/user/exportUserConsumption").concat(Object(f.c)(a)))},transformQueryUserParams:function(){var e=this.queryUserIncrease,t=e.type,r=e.date,n={type:t,year:Object(a.format)(r,"YYYY"),month:""};return 1===t&&(n.month=Object(a.format)(r,"MM")),n}}},b=Object(o.a)(v,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:e.prefixCls},[r("div",{staticClass:"member-item"},[r("div",{staticClass:"filter"},[r("div",[e._v("会员增长情况")]),e._v(" "),r("div",[r("el-button",{attrs:{icon:"el-icon-download",type:"primary"},on:{click:e.handleExportUser}},[e._v("导出数据")]),e._v(" "),r("el-select",{attrs:{placeholder:"请选择"},on:{input:e.onInputQueryUserParam},model:{value:e.queryUserIncrease.type,callback:function(t){e.$set(e.queryUserIncrease,"type",t)},expression:"queryUserIncrease.type"}},e._l(e.queryOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),r("el-date-picker",{attrs:{clearable:!1,type:1===e.queryUserIncrease.type?"month":"year",placeholder:"选择年"},on:{input:e.onInputQueryUserParam},model:{value:e.queryUserIncrease.date,callback:function(t){e.$set(e.queryUserIncrease,"date",t)},expression:"queryUserIncrease.date"}})],1)]),e._v(" "),r("line-chart",{attrs:{yAxisName:"（个）",height:"300px",width:"100%",xAxisData:e.userIncreate.xAxisData,seriesData:e.userIncreate.seriesData}})],1),e._v(" "),r("div",{staticClass:"member-item"},[r("div",{staticClass:"filter"},[r("div",[e._v("会员端口来源")]),e._v(" "),r("div",[r("el-button",{attrs:{icon:"el-icon-download",type:"primary"},on:{click:e.handleExportUserPortSource}},[e._v("导出数据")]),e._v(" "),r("el-select",{attrs:{placeholder:"请选择"},on:{input:e.onInputQueryUserPortSource},model:{value:e.queryUserPortSource.type,callback:function(t){e.$set(e.queryUserPortSource,"type",t)},expression:"queryUserPortSource.type"}},e._l(e.queryOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),r("el-date-picker",{attrs:{clearable:!1,type:1===e.queryUserPortSource.type?"month":"year",placeholder:"选择年"},on:{input:e.onInputQueryUserPortSource},model:{value:e.queryUserPortSource.date,callback:function(t){e.$set(e.queryUserPortSource,"date",t)},expression:"queryUserPortSource.date"}})],1)]),e._v(" "),r("pie",{attrs:{height:"300px",width:"100%",legendData:e.userPortSource.legendData,seriesData:e.userPortSource.seriesData}})],1),e._v(" "),r("div",{staticClass:"member-item"},[r("div",{staticClass:"filter"},[r("div",[e._v("会员消费金额分布")]),e._v(" "),r("div",[r("el-button",{attrs:{type:"primary"},on:{click:e.handleExportUserConsume}},[e._v("导出数据")]),e._v(" "),r("el-select",{attrs:{placeholder:"请选择"},on:{input:e.onQueryUserConsume},model:{value:e.queryUserConsume.type,callback:function(t){e.$set(e.queryUserConsume,"type",t)},expression:"queryUserConsume.type"}},e._l(e.queryOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),r("el-date-picker",{attrs:{clearable:!1,type:1===e.queryUserConsume.type?"month":"year",placeholder:"选择年"},on:{input:e.onQueryUserConsume},model:{value:e.queryUserConsume.date,callback:function(t){e.$set(e.queryUserConsume,"date",t)},expression:"queryUserConsume.date"}})],1)]),e._v(" "),r("bar",{attrs:{height:"300px",width:"100%",option:e.userConsumeChartOption}})],1)])},[],!1,null,null,null);b.options.__file="index.vue";t.default=b.exports},627:function(e,t,r){"use strict";r.d(t,"b",function(){return s}),r.d(t,"d",function(){return i}),r.d(t,"a",function(){return o}),r.d(t,"c",function(){return u});var a=r(634);function n(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,s;return t=e,s=[{key:"format",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e&&"number"==typeof e?Object(a.format)(e,t):""}}],(r=null)&&n(t.prototype,r),s&&n(t,s),e}(),i=function(e,t){for(var r=[],n=e;n<=t;)r.push(Object(a.format)(n,"YYYY-MM-DD")),n+=864e5;return r},o=function(e){for(var t=[],r=1;r<13;r++)r<10?t.push("".concat(e,"-0").concat(r)):t.push("".concat(e,"-").concat(r));return t},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e&&"number"==typeof e?Object(a.format)(e,t):""}},647:function(e,t,r){"use strict";var a=r(630),n=r.n(a);r(775),r(785),r(786),r(787),r(791);t.a=n.a},653:function(e,t,r){"use strict";var a=r(86);t.a={mounted:function(){var e=this;this.resizeHanlder=Object(a.a)(function(){e.chart&&e.chart.resize()},100),window.addEventListener("resize",this.resizeHanlder)},beforeDestroy:function(){window.removeEventListener("resize",this.resizeHanlder)}}},708:function(e,t,r){"use strict";var a=r(647),n={mixins:[r(653).a],name:"bar",props:{width:{type:String,default:"200px"},height:{type:String,default:"200px"},option:{type:Object,default:{}}},data:function(){return{chart:null,chartOption:{}}},mounted:function(){this.initChart()},beforeUpdate:function(){this.initChart()},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=a.a.init(this.$refs.bar),this.chart.setOption(this.option)}},watch:{option:{handler:function(e,t){this.chart?e?this.chart.setOption(e):this.chart.setOption(t):this.initChart()},deep:!0}}},s=r(13),i=Object(s.a)(n,function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"bar",style:{height:this.height,width:this.width}})},[],!1,null,null,null);i.options.__file="bar.vue";t.a=i.exports},709:function(e,t,r){"use strict";var a=r(647),n={mixins:[r(653).a],props:{title:{type:String,default:""},width:{type:String,default:"200px"},height:{type:String,default:"200px"},yAxisName:{type:String,default:""},xAxisData:{type:Array,default:function(){return[]}},seriesData:{type:Array,default:function(){return[]}}},data:function(){return{chart:null}},mounted:function(){this.initChart()},beforeUpdate:function(){this.initChart()},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=a.a.init(this.$refs.line),this.chart.setOption({backgroundColor:"#fff",tooltip:{trigger:"axis",axisPointer:{lineStyle:{color:"#57617B"}}},grid:{top:30,left:10,right:"4%",bottom:"2%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,axisLine:{lineStyle:{color:"#57617B"}},data:this.xAxisData}],yAxis:[{type:"value",name:this.yAxisName}],series:[{type:"line",smooth:!0,symbol:"circle",symbolSize:5,showSymbol:!1,lineStyle:{normal:{width:1}},areaStyle:{normal:{color:new a.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(137, 189, 27, 0.3)"},{offset:.8,color:"rgba(137, 189, 27, 0)"}],!1),shadowColor:"rgba(0, 0, 0, 0.1)",shadowBlur:10}},itemStyle:{normal:{color:"rgb(137,189,27)",borderColor:"rgba(137,189,2,0.27)",borderWidth:12}},data:this.seriesData}]})}}},s=r(13),i=Object(s.a)(n,function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"line",style:{height:this.height,width:this.width},attrs:{xAxisData:this.seriesData}})},[],!1,null,null,null);i.options.__file="line.vue";t.a=i.exports}}]);